{% extends 'base.html' %}

{% block title %}{{ topic.subject }}{% endblock %}
{% load gravatar %}
{% block breadcrumb %}
<li class="inline-block">
    <a href="{% url 'home' %}" class="text-blue-500 hover:text-blue-700">Boards</a>
</li>
<span class="mx-2 text-gray-500">/</span>
<li class="inline-block">
    <a href="{% url 'board_topics' topic.board.pk %}" class="text-blue-500 hover:text-blue-700">{{ topic.board.name }}</a>
</li>
<span class="mx-2 text-gray-500">/</span>
<li class="inline-block">
    {{ topic.subject }}
</li>
{% endblock %}

{% block content %}

<div class="mb-4">
    <a href="{% url 'reply_topic' topic.board.pk topic.pk %}"
        class="bg-blue-500 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded" role="button">Reply</a>
</div>

{% for post in topic.posts.all %}
<div class="mb-4 shadow-md rounded-lg {% if forloop.first %}border-l-4 border-gray-800{% endif %}">
    {% if forloop.first %}
    <div class="bg-gray-800 text-white py-2 px-3 rounded-t-lg">{{ topic.subject }}</div>
    {% endif %}
    <div class="p-4 bg-white rounded-b-lg">
        <div class="flex">
            <div class="w-1/4">
                <img src="{{ post.created_by|gravatar }}" alt="{{ post.created_by.username }}" class="w-12 h-12 rounded-full mx-auto">

                <small class="block text-gray-500 mt-2">Posts: {{ post.created_by.posts.count }}</small>
            </div>
            <div class="w-3/4 pl-4">
                <div class="flex justify-between mb-3">
                    <strong class="text-gray-700">{{ post.created_by.username }}</strong>
                    <small class="text-gray-500">{{ post.created_at }}</small>
                </div>
                <p class="text-gray-800">{{ post.message }}</p>
                {% if post.created_by == user %}
                <div class="mt-3">
                    <a href="{% url 'edit_post' post.topic.board.pk post.topic.pk post.pk %}" class="bg-blue-500 hover:bg-blue-700 text-white text-sm font-bold py-1 px-3 rounded"
                        role="button">Edit</a>
                </div>
                {% endif %}
            </div>
        </div>
    </div>
</div>
{% endfor %}
{% include 'includes/pagination.html' %}

{% endblock %}